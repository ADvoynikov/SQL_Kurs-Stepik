# Запросы корректировки данных

### Содержание <br>
[Создание пустой таблицы](#T1)<br>
[Добавление записей в таблицу](#T2)<br>
[Добавление записей из другой таблицы, вложенные запросы](#T3)<br>



<br>

<br><a name="T1"></a>
# Создание пустой таблицы

Создание таблицы осуществляется с помощью запроса `CREATE`, подробно рассмотренного в [первой странице](https://github.com/EMIR1HUB/All_Conspectus/blob/main/SQL/1_base_Table.md).

#### **Пример** Создать таблицу поставка (`supply`), которая имеет ту же структуру, что и таблиц `book`.

```SQL
CREATE TABLE supply(
    supply_id INT PRIMARY KEY AUTO_INCREMENT,
    title VARCHAR(50),
    author VARCHAR(30),
    price DECIMAL(8,2),
    amount INT
)
```
___


<br><a name="T2"></a>
# Добавление записей в таблицу

Добавление одной записи в таблицу осуществляется с помощью запроса INSERT, подробно рассмотренного в [первой странице](https://github.com/EMIR1HUB/All_Conspectus/blob/main/SQL/1_base_Table.md).

#### **Пример** Занесите в таблицу `supply` четыре записи:

```SQL
INSERT INTO supply(title, author, price, amount)
VALUES ('Лирика', 'Пастернак Б.Л.', 518.99, 2),
    ('Черный человек', 'Есенин С.А.', 570.20, 6),
    ('Белая гвардия', 'Булгаков М.А.', 540.50, 7),
    ('Идиот', 'Достоевский Ф.М.', 360.80, 3);

SELECT * FROM supply;

--решение
+-----------+----------------+------------------+--------+--------+
| supply_id | title          | author           | price  | amount |
+-----------+----------------+------------------+--------+--------+
| 1         | Лирика         | Пастернак Б.Л.   | 518.99 | 2      |
| 2         | Черный человек | Есенин С.А.      | 570.20 | 6      |
| 3         | Белая гвардия  | Булгаков М.А.    | 540.50 | 7      |
| 4         | Идиот          | Достоевский Ф.М. | 360.80 | 3      |
+-----------+----------------+------------------+--------+--------+
```
___


<br><a name="T3"></a>
# Добавление записей из другой таблицы, вложенные запросы

С помощью запроса на добавление можно добавить записи из другой таблицы, отобранные с помощью запроса на выборку. В этом случае вместо раздела `VALUES` записывается запрос на выборку, `SELECT`.  В нем можно использовать `WHERE`, `GROUP BY`, `ORDER BY`.

Правила соответствия между полями таблицы и вставляемыми значениями из запроса:

1. количество полей в таблице и в запросе должны совпадать;
2. должно существовать прямое соответствие между позицией одного и того же элемента в обоих списках, первый столбец запроса к первому столбцу в списке столбцов таблицы, второй – ко второму и т.д.
3. типы столбцов запроса должны быть совместимы с типами данных соответствующих столбцов таблицы ( `INT` можно занести в поле типа `DECIMAL`, обратная операция – недопустима).

#### **Пример** Занести все книги из таблицы `supply` в таблицу `book`
```SQL
INSERT INTO book (title, author, price, amount) 
SELECT title, author, price, amount 
FROM supply;
```
> С помощью этого запроса в таблицу `book` включены все книги из `supply`, даже те, которые в `book` уже есть («Белая гвардия» и «Идиот»). Для реляционной модели это нежелательная ситуация. Устранить эту проблему можно с помощью вложенных запросов.

#### **Пример** Занести из таблицы `supply` в таблицу `book` только те книги, названия которых отсутствуют в таблице `book`.
```SQL
INSERT INTO book (title, author, price, amount) 
SELECT title, author, price, amount 
FROM supply
WHERE title NOT IN (
        SELECT title 
        FROM book
        );

SELECT * FROM book;
```
> Вложенным запросом отбираются все названия книг, которые есть в таблице `book`. Основным запросом `SELECT` из таблицы `supply` выбираются книги, названия которых нет в результате вложенного запроса. Отобранные записи добавляются в конец таблицы `book`.
___


