# Таблица "Командировки", запросы на выборку

### Содержание
[Оператор LIMIT]()<br>

<br>
Таблица `trip`, в которой представлена информация о командировках сотрудников некоторой организации (фамилия сотрудника, город, куда он ездил, размер суточных, даты первого и последнего дня командировки) :

|trip_id | name | city | per_diem | date_first | date_last|
| -----  | -----| -----| -------- | ---------- | ---------|
|INT PRIMARY KEY AUTO_INCREMENT | VARCHAR(30) | VARCHAR(25) | DECIMAL(8,2) | DATЕ | DATE |
___
<br>

#### **Пример** Вывести из таблицы `trip` информацию о командировках тех сотрудников, фамилия которых заканчивается на букву «а», в отсортированном по убыванию даты последнего дня командировки виде. В результат включить столбцы `name, city, per_diem, date_first, date_last`.

```sql
SELECT name, city, per_diem, date_first, date_last
FROM trip
WHERE name LIKE "%а %"
ORDER BY date_last DESC;

--результат
+---------------+-----------------+----------+------------+------------+
| name          | city            | per_diem | date_first | date_last  |
+---------------+-----------------+----------+------------+------------+
| Абрамова К.А. | Владивосток     | 450.00   | 2020-07-02 | 2020-07-13 |
| Федорова А.Ю. | Томск           | 450.00   | 2020-06-20 | 2020-06-26 |
| Абрамова К.А. | Санкт-Петербург | 700.00   | 2020-05-28 | 2020-06-04 |
| Федорова А.Ю. | Новосибирск     | 450.00   | 2020-05-25 | 2020-06-04 |
| Абрамова К.А. | Москва          | 700.00   | 2020-04-06 | 2020-04-14 |
| Абрамова К.А. | Москва          | 700.00   | 2020-02-23 | 2020-03-01 |
| Абрамова К.А. | Владивосток     | 450.00   | 2020-01-14 | 2020-01-27 |
+---------------+-----------------+----------+------------+------------+
```
___
<br>

#### **Пример** Вывести в алфавитном порядке фамилии и инициалы тех сотрудников, которые были в командировке в Москве.

```SQL
SELECT DISTINCT name
FROM trip
WHERE city = 'Москва'
ORDER BY name;

--эквивалентно
WHERE city LIKE '%Москва%'

--результат
+---------------+
| name          |
+---------------+
| Абрамова К.А. |
| Баранов П.Е.  |
| Колесов С.П.  |
| Лебедев Т.К.  |
| Семенов И.В.  |
+---------------+
```
___
<br>

#### **Пример** Для каждого города посчитать, сколько раз сотрудники в нем были.  Информацию вывести в отсортированном в алфавитном порядке по названию городов. Вычисляемый столбец назвать **Количество**. 

```SQL
SELECT city, 
    (SELECT COUNT(city)) 
    AS Количество
FROM trip
GROUP BY city 
ORDER BY city;

--результат
+-----------------+------------+
| city            | Количество |
+-----------------+------------+
| Владивосток     | 3          |
| Воронеж         | 1          |
| Москва          | 7          |
| Новосибирск     | 4          |
| Санкт-Петербург | 3          |
| Томск           | 2          |
+-----------------+------------+
```
___
<br>

# Оператор LIMIT

Для ограничения вывода записей в SQL используется оператор `LIMIT` , после которого указывается количество строк.  Результирующая таблица будет иметь количество строк не более указанного после `LIMIT`. `LIMIT` размещается после раздела `ORDER BY`.

#### **Пример** Вывести информацию о первой  командировке из таблицы `trip`. "Первой" считать командировку с самой ранней датой начала.

```SQL
SELECT *
FROM trip
ORDER BY  date_first
LIMIT 1;

--результат
+---------+--------------+--------+----------+------------+------------+
| trip_id | name         | city   | per_diem | date_first | date_last  |
+---------+--------------+--------+----------+------------+------------+
| 1       | Баранов П.Е. | Москва | 700.00   | 2020-01-12 | 2020-01-17 |
+---------+--------------+--------+----------+------------+------------+
```
> Важно. Оператор `LIMIT` нужно использовать очень осторожно. Например, если бы в таблице trip было несколько командировок с одинаковой датой начала, этот запрос работал бы НЕВЕРНО. Это связано с тем, что заранее не известно точное значение таких командировок.

#### **Пример** Вывести два города, в которых чаще всего были в командировках сотрудники. Вычисляемый столбец назвать Количество.

```SQL
SELECT city, COUNT(city) AS Количество
FROM trip
GROUP BY city
ORDER BY Количество DESC
LIMIT 2;

--результат
+-------------+------------+
| city        | Количество |
+-------------+------------+
| Москва      | 7          |
| Новосибирск | 4          |
+-------------+------------+
```
___